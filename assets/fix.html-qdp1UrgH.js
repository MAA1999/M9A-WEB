import{_ as n,c as t,a as l,b as e,e as s,d as p,w as r,r as h,o as d}from"./app-Biz-8gg7.js";const o={};function g(k,i){const a=h("VPLink");return d(),t("div",null,[i[3]||(i[3]=l('<p>修 bug 也是开发中重要的一环。<br> 如何快速准确地定位、分析、解决 bug 是有技巧的。<br> 本文将简单介绍排查 bug 的一般流程。</p><div class="hint-container note"><p class="hint-container-title">注</p><p>以下内容仅供参考，注意时效性。</p></div><h2 id="前置准备" tabindex="-1"><a class="header-anchor" href="#前置准备"><span>前置准备</span></a></h2><p>与 bug 提出者沟通，尽可能的获取 bug 相关的信息，如：</p><ul><li>问题的细节描述（发生的时间、场景等）</li><li>配置文件、日志、截图等必要信息</li></ul><h2 id="定位关键-log" tabindex="-1"><a class="header-anchor" href="#定位关键-log"><span>定位关键 log</span></a></h2><ol><li><p>确认资源版本以及运行方式</p><p>对于 M9A 来说，有两种运行方式：1. MaaPiCli 2. MFA</p><p>log 一般在以下位置：</p><ul><li>logs 文件夹下 MFA 的 log</li><li>debug 文件夹下的 maa.log</li><li>debug/custom 文件夹下 custom 生成的 log</li></ul><p>下面简单说下 maa.log 中的版本如何找。<br> 根据观察，MaaPiCli 运行时有行log为</p><div class="language-plaintext line-numbers-mode" data-highlighter="shiki" data-ext="plaintext" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plaintext"><span class="line"><span>[2024-11-28 19:46:32.571][INF][Px14600][Tx16498][Parser.cpp][L56][MaaNS::ProjectInterfaceNS::Parser::parse_interface] Interface Version: [data.version=v2.4.11]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>而 MFAWPF 运行时有log为</p><div class="language-plaintext line-numbers-mode" data-highlighter="shiki" data-ext="plaintext" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-plaintext"><span class="line"><span>MFAWPF Version: [mfa.version=v1.2.2.0] Interface Version: [data.version=v2.5.5]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>由 data.version 可以确定资源版本。以此判断当前问题发生的版本是否已修复当前 bug。<br> 同时确认运行方式。因为不同运行方式，可能影响问题的复刻。</p></li><li><p>定位问题所在的 log 位置</p><p>分两种情况：</p><ul><li>任务提前结束</li><li>任务陷入无限循环</li></ul><p>前者全局搜素 <strong>[ERR]</strong> ，查看报错是与什么有关。<br> 后者全局搜索 <strong>Node Hit</strong> ，查找不正常的匹配情况（如持续匹配一个本不该一直匹配的 node）。</p></li></ol><h2 id="分析问题" tabindex="-1"><a class="header-anchor" href="#分析问题"><span>分析问题</span></a></h2><p>在这里我将问题大致分为三类：资源加载问题、连接问题以及 pipeline 问题。</p><h3 id="资源加载问题" tabindex="-1"><a class="header-anchor" href="#资源加载问题"><span>资源加载问题</span></a></h3><p>资源改名时覆盖安装导致的资源加载失败：</p><div class="language-log line-numbers-mode" data-highlighter="shiki" data-ext="log" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-log"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">[</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">2024-11-17</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> 22:29:04.185</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[ERR]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">[Px10564][Tx9380][</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">PipelineResMgr.cpp</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">][L211][MaaNS::ResourceNS::PipelineResMgr::parse_config] key already exists [key=OutsideDeduction]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="连接问题" tabindex="-1"><a class="header-anchor" href="#连接问题"><span>连接问题</span></a></h3><p>模拟器连接失败：</p><div class="language-log line-numbers-mode" data-highlighter="shiki" data-ext="log" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-log"><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">[</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">2024-11-24</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> 23:44:05.539</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[ERR]</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">[Px26056][Tx55883][</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">ControlUnitMgr.cpp</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">][L55][MaaNS::CtrlUnitNs::ControlUnitMgr::connect] failed to connect [adb_path_=D:/MuMu Player </span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">12</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">/shell/adb.exe] [adb_serial_=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">127</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">0</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">.</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">1</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">16384</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="pipeline-问题" tabindex="-1"><a class="header-anchor" href="#pipeline-问题"><span>Pipeline 问题</span></a></h3><p>这类是 M9A 主要需要关注的问题，需要了解原 pipeline 流程以及 log 展示的执行情况，加以分析。</p><ol><li><p>非 pipeline 流程类问题</p><p>这种问题本身 pipeline 流程逻辑上没有问题。</p><p>根据出问题的 node 分为两种：</p><p>第一种是 非 无条件匹配/inverse node。<br> 常见原因是截图截太快了，匹配到 <code>next</code> 中 node，但当前画面尚未未稳定。<br> 解决方案是为当前 node 添加合适的 <code>post_wait_freezes</code>，等待画面稳定再做判断。</p><p>第二种是 无条件匹配/inverse node。<br> 这种可能是进到非预期界面，导致判断失误。<br> 解决方案是按需修改。</p></li><li><p>pipeline 流程类问题</p><p>这种是任务流程本身完备性不足，需在分析后修改。</p></li></ol><h2 id="解决问题" tabindex="-1"><a class="header-anchor" href="#解决问题"><span>解决问题</span></a></h2>',19)),e("p",null,[i[1]||(i[1]=s("前两种参考",-1)),p(a,{href:"../manual/faq.md"},{default:r(()=>[...i[0]||(i[0]=[s("常见问题",-1)])]),_:1}),i[2]||(i[2]=s("解决，pipeline 问题根据分析结果修改。",-1))]),i[4]||(i[4]=e("h2",{id:"验证修复",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#验证修复"},[e("span",null,"验证修复")])],-1)),i[5]||(i[5]=e("p",null,"修复后发布测试版，经测试无误后解决问题。",-1))])}const u=n(o,[["render",g]]),b=JSON.parse('{"path":"/zh_cn/develop/fix.html","title":"Bug 排查","lang":"zh-CN","frontmatter":{"order":6,"icon":"qlementine-icons:debug-16","title":"Bug 排查","description":"修 bug 也是开发中重要的一环。 如何快速准确地定位、分析、解决 bug 是有技巧的。 本文将简单介绍排查 bug 的一般流程。 注 以下内容仅供参考，注意时效性。 前置准备 与 bug 提出者沟通，尽可能的获取 bug 相关的信息，如： 问题的细节描述（发生的时间、场景等） 配置文件、日志、截图等必要信息 定位关键 log 确认资源版本以及运行方式...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Bug 排查\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://1999.fan/zh_cn/develop/fix.html"}],["meta",{"property":"og:site_name","content":"M9A 文档站"}],["meta",{"property":"og:title","content":"Bug 排查"}],["meta",{"property":"og:description","content":"修 bug 也是开发中重要的一环。 如何快速准确地定位、分析、解决 bug 是有技巧的。 本文将简单介绍排查 bug 的一般流程。 注 以下内容仅供参考，注意时效性。 前置准备 与 bug 提出者沟通，尽可能的获取 bug 相关的信息，如： 问题的细节描述（发生的时间、场景等） 配置文件、日志、截图等必要信息 定位关键 log 确认资源版本以及运行方式..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://1999.fan/en_us/develop/fix.html"}]]},"readingTime":{"minutes":2.52,"words":756},"git":{},"autoDesc":true,"filePathRelative":"zh_cn/develop/fix.md","headers":[]}');export{u as comp,b as data};
